{% extends "base.html" %}

{% block content %}
<section class="perfil-section">
    <div class="perfil-container">
        <!-- Cabe√ßalho do perfil -->
        <div class="perfil-header">
            <div class="perfil-avatar">
                {% if session.get('inadmin') == 2 %}
                    <div class="avatar-empresa"><img src="static/images/empresaicon.png"></div>
                {% elif session.get('inadmin') == 1 %}
                    <div class="avatar-admin"><img src="static/images/adminicon.png"></div>
                {% else %}
                    <div class="avatar-usuario"><img src="static/images/usericon.png"></div>
                {% endif %}
            </div>
            
            <div class="perfil-titulo">
                <h1>Meu Perfil</h1>
                <p class="perfil-subtitulo">
                    {% if session.get('inadmin') == 2 %}
                        Conta Empresarial
                    {% elif session.get('inadmin') == 1 %}
                        Conta Administrativa
                    {% else %}
                        Conta Pessoal
                    {% endif %}
                </p>
            </div>
        </div>

        <!-- Informa√ß√µes do usu√°rio -->
        <div class="perfil-info-card">
            <h2> Informa√ß√µes Pessoais</h2>
            
            <div class="info-grid">
                <div class="info-item">
                    <span class="info-label">Nome:</span>
                    <span class="info-value">{{ session.get('usuario') }}</span>
                </div>
                
                <div class="info-item">
                    <span class="info-label">ID de Usu√°rio:</span>
                    <span class="info-value">#{{ session.get('id_usuario') }}</span>
                </div>
                
                <div class="info-item">
                    <span class="info-label">Tipo de Conta:</span>
                    <span class="info-value">
                        {% if session.get('inadmin') == 2 %}
                            <span class="badge badge-empresa"> Empresa</span>
                        {% elif session.get('inadmin') == 1 %}
                            <span class="badge badge-admin"> Administrador</span>
                        {% else %}
                            <span class="badge badge-usuario"> Usu√°rio Normal</span>
                        {% endif %}
                    </span>
                </div>
                
                <div class="info-item">
                    <span class="info-label">Status:</span>
                    <span class="info-value">
                        <span class="status-logado">Online</span>
                    </span>
                </div>
            </div>
        </div>

        <!-- Estat√≠sticas -->
        <div class="estatisticas-card">
            <h2> Minhas Estat√≠sticas</h2>

            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-icon"></div>
                    <div class="stat-content">
                        <span class="stat-number">{{ total_avaliacoes }}</span>
                        <span class="stat-label">
                            {% if session.get('inadmin') == 2 %}
                                Avalia√ß√µes Recebidas
                            {% else %}
                                Avalia√ß√µes Feitas
                            {% endif %}
                        </span>
                    </div>
                </div>
                
                <div class="stat-item">
                    <div class="stat-icon"></div>
                    <div class="stat-content">
                        <span class="stat-number">{{ total_comentarios }}</span>
                        <span class="stat-label">Coment√°rios</span>
                    </div>
                </div>
                
                <div class="stat-item">
                    <div class="stat-icon"></div>
                    <div class="stat-content">
                        <span class="stat-number">{{ total_pesquisas }}</span>
                        <span class="stat-label">Pesquisas</span>
                    </div>
                </div>
                
                <div class="stat-item">
                    <div class="stat-icon"></div>
                    <div class="stat-content">
                        <span class="stat-number">{{ dias_cadastro }}</span>
                        <span class="stat-label">Dias no Sistema</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- A√ß√µes r√°pidas -->
        <div class="acoes-card">
            <h2>A√ß√µes R√°pidas</h2>
            
            <div class="acoes-grid">
                <a href="{{ url_for('editar') }}" class="acao-item">
                    <div class="acao-icon"></div>
                    <div class="acao-content">
                        <span class="acao-title">Editar Perfil</span>
                        <span class="acao-desc">Atualizar dados pessoais</span>
                    </div>
                    <div class="acao-arrow">‚Üí</div>
                </a>
                
                {% if session.get('inadmin') != 2 %}
                <a href="{{ url_for('nova_avaliacao') }}" class="acao-item">
                    <div class="acao-icon"></div>
                    <div class="acao-content">
                        <span class="acao-title">Fazer Avalia√ß√£o</span>
                        <span class="acao-desc">Avaliar uma empresa</span>
                    </div>
                    <div class="acao-arrow">‚Üí</div>
                </a>
                {% endif %}
                
                <a href="{{ url_for('meu_historico') }}" class="acao-item">
                    <div class="acao-icon"></div>
                    <div class="acao-content">
                        <span class="acao-title">Meu Hist√≥rico</span>
                        <span class="acao-desc">Ver minhas atividades</span>
                    </div>
                    <div class="acao-arrow">‚Üí</div>
                </a>
                
                <a href="{{ url_for('listar_avaliacoes') }}" class="acao-item">
                    <div class="acao-icon"></div>
                    <div class="acao-content">
                        <span class="acao-title">Ver Avalia√ß√µes</span>
                        <span class="acao-desc">
                            {% if session.get('inadmin') == 2 %}
                                Ver avalia√ß√µes da minha empresa
                            {% else %}
                                Ver todas avalia√ß√µes
                            {% endif %}
                        </span>
                    </div>
                    <div class="acao-arrow">‚Üí</div>
                </a>
                
                {% if session.get('inadmin') == 1 %}
                <a href="{{ url_for('listusuario') }}" class="acao-item">
                    <div class="acao-icon"></div>
                    <div class="acao-content">
                        <span class="acao-title">Gerenciar Usu√°rios</span>
                        <span class="acao-desc">Painel administrativo</span>
                    </div>
                    <div class="acao-arrow">‚Üí</div>
                </a>
                {% endif %}
            </div>
        </div>

        <!-- Conte√∫do espec√≠fico por tipo de usu√°rio -->
        {% if session.get('inadmin') != 2 %}
        <!-- Minhas √∫ltimas avalia√ß√µes (apenas para usu√°rios normais e admin) -->
        <div class="avaliacoes-recentes-card">
            <div class="card-header">
                <h2> Minhas √öltimas Avalia√ß√µes</h2>
                <a href="{{ url_for('listar_avaliacoes') }}" class="ver-todas">Ver todas ‚Üí</a>
            </div>
            
            {% if ultimas_avaliacoes %}
                <div class="avaliacoes-lista">
                    {% for avaliacao in ultimas_avaliacoes %}
                    <div class="avaliacao-mini-item">
                        <div class="avaliacao-mini-header">
                            <span class="empresa-mini">üè¢ {{ avaliacao.nome_empresa }}</span>
                            <span class="nota-mini">
                                {% for i in range(1, 6) %}
                                    {% if i <= avaliacao.nota %}
                                        ‚òÖ
                                    {% else %}
                                        ‚òÜ
                                    {% endif %}
                                {% endfor %}
                            </span>
                        </div>
                        <p class="texto-mini">{{ avaliacao.texto[:100] }}{% if avaliacao.texto|length > 100 %}...{% endif %}</p>
                        <div class="avaliacao-mini-info">
                            <span class="data-mini">{{ avaliacao.dataPublicada }}</span>
                            <div class="avaliacao-mini-actions">
                                <a href="{{ url_for('editar_avaliacao', id=avaliacao.id) }}" class="btn-mini-editar">Editar</a>
                                <a href="{{ url_for('excluir_avaliacao', id=avaliacao.id) }}" 
                                   class="btn-mini-excluir"
                                   onclick="return confirm('Excluir esta avalia√ß√£o?');">Excluir</a>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="sem-conteudo">
                    <p>Voc√™ ainda n√£o fez nenhuma avalia√ß√£o.</p>
                    <a href="{{ url_for('nova_avaliacao') }}" class="btn-nova-avaliacao">‚ûï Fazer primeira avalia√ß√£o</a>
                </div>
            {% endif %}
        </div>
        {% else %}
        <!-- Conte√∫do espec√≠fico para empresas -->
        <div class="empresa-info-card">
            <h2> Informa√ß√µes da Empresa</h2>
            <div class="empresa-content">
                <p>Como empresa, voc√™ pode:</p>
                <ul class="empresa-beneficios">
                    <li> Ver todas as avalia√ß√µes sobre sua empresa</li>
                    <li> Responder aos coment√°rios dos usu√°rios</li>
                    <li> Acompanhar o hist√≥rico de atividades</li>
                    <li>Manter seus dados atualizados</li>
                </ul>
                <div class="empresa-actions">
                    <a href="{{ url_for('listar_avaliacoes') }}" class="btn-empresa">
                         Ver Avalia√ß√µes da Empresa
                    </a>
                    <a href="{{ url_for('meu_historico') }}" class="btn-empresa">
                         Ver Hist√≥rico Completo
                    </a>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Informa√ß√µes da conta -->
        <div class="conta-info-card">
            <h2> Informa√ß√µes da Conta</h2>
            
            <div class="conta-info">
                <div class="conta-item">
                    <span class="conta-label">Data de Cadastro:</span>
                    <span class="conta-value">{{ data_cadastro }}</span>
                </div>
                
                <div class="conta-item">
                    <span class="conta-label">√öltimo Login:</span>
                    <span class="conta-value">{{ ultimo_login }}</span>
                </div>
                
                <div class="conta-item">
                    <span class="conta-label">Seguran√ßa:</span>
                    <span class="conta-value">
                        <span class="seguranca-status"> Senha ativa</span>
                    </span>
                </div>
            </div>
            
            <div class="conta-actions">
                <a href="{{ url_for('editar') }}" class="btn-conta-alterar">Alterar Senha</a>
                <a href="{{ url_for('logout') }}" class="btn-conta-sair" 
                   onclick="return confirm('Deseja realmente sair?');">Sair da Conta</a>
            </div>
        </div>
    </div>
</section>


{% endblock %}
{% extends "base.html" %}

{% block content %}

    <div class="info-pesquisa">
        <h2> Resultados da Pesquisa : </h2>
        <p>Termo pesquisado: "{{ termo }}"</p>
        <p>Encontrados: <strong>{{ total_resultados }} resultado(s)</strong></p>
        <a href="{{ url_for('index') }}" class="btn-voltar">‚Üê Voltar para In√≠cio</a>
    </div>

    {% if resultados %}
        <div class="avaliacoes-lista">
            {% for avaliacao in resultados %}
            <div class="avaliacao-item">
                <div class="avaliacao-header">
                    <h3>{{ avaliacao.nomePessoaPublicou }}</h3>
                    <span class="empresa-avaliada">üè¢ {{ avaliacao.nome_empresa }}</span>
                    <span class="nota-estrelas">
                        <span class="nota-estrelas">
                            {% if avaliacao.nota <= 5 %}
                                {% for i in range(1, 6) %}
                                    {% if i <= avaliacao.nota %}
                                        ‚òÖ
                                    {% else %}
                                        ‚òÜ
                                    {% endif %}
                                {% endfor %}
                            {% else %}
                                <!-- Sistema antigo se necess√°rio -->
                            {% endif %}
                        </span>
                    </span>
                </div>
                <p class="avaliacao-texto">{{ avaliacao.texto }}</p>
                <div class="avaliacao-info">
                    <span class="data">Publicado em: {{ avaliacao.dataPublicada }}</span>
                    <span class="comentarios">{{ avaliacao.total_comentarios }} coment√°rios</span>
                </div>
                
                <!-- √ÅREA DE COMENT√ÅRIOS -->
                {% if avaliacao.comentarios %}
                <div class="comentarios-area">
                    <h4>Coment√°rios ({{ avaliacao.total_comentarios }}):</h4>
                    <div class="comentarios-lista">
                        {% for comentario in avaliacao.comentarios %}
                        <div class="comentario-item">
                            <div class="comentario-header">
                                <strong>{{ comentario.nome_usuario_comentou }}</strong>
                                <span class="data-comentario">{{ comentario.data_comentario }}</span>
                            </div>
                            <p class="comentario-texto">{{ comentario.texto }}</p>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
            </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="sem-resultados">
            <p>‚ùå Nenhum resultado encontrado para "{{ termo }}"</p>
            <p>Tente pesquisar por:</p>
            <ul>
                <li>Nome de usu√°rio</li>
                <li>Texto da avalia√ß√£o</li>
                <li>Nota (ex: 8, 9, 10)</li>
            </ul>
            <a href="{{ url_for('index') }}" class="btn-voltar">‚Üê Voltar para In√≠cio</a>
        </div>
    {% endif %}
</section>

{% endblock %}